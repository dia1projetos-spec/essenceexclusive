<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Firebase - Essence Exclusive</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; padding: 2rem; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 2rem; border-radius: 10px; }
        h1 { color: #333; margin-bottom: 2rem; }
        .section { margin: 2rem 0; padding: 1.5rem; background: #f9f9f9; border-radius: 8px; }
        .section h2 { color: #666; margin-bottom: 1rem; font-size: 1.2rem; }
        button { background: #c4a76b; color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 5px; cursor: pointer; margin: 0.5rem; }
        button:hover { background: #b39660; }
        #log { background: #000; color: #0f0; padding: 1rem; border-radius: 5px; font-family: monospace; font-size: 0.9rem; max-height: 400px; overflow-y: auto; }
        .log-line { margin: 0.2rem 0; }
        .success { color: #0f0; }
        .error { color: #f00; }
        .info { color: #0ff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• Teste de Conectividade Firebase</h1>
        
        <div class="section">
            <h2>1. Testar Conex√£o</h2>
            <button onclick="testFirebase()">Testar Firebase</button>
            <button onclick="testAuth()">Testar Auth</button>
            <button onclick="testFirestore()">Testar Firestore</button>
        </div>
        
        <div class="section">
            <h2>2. Dados de Teste</h2>
            <button onclick="addTestProduct()">Adicionar Produto Teste</button>
            <button onclick="loadAllProducts()">Carregar Produtos</button>
            <button onclick="clearLog()">Limpar Log</button>
        </div>
        
        <div class="section">
            <h2>3. Log do Sistema</h2>
            <div id="log"></div>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyA-pWZ8CSQJURUAgfz9JSVerHGGkovZmbs",
            authDomain: "essence-exclusive-a4252.firebaseapp.com",
            projectId: "essence-exclusive-a4252",
            storageBucket: "essence-exclusive-a4252.firebasestorage.app",
            messagingSenderId: "608148583018",
            appId: "1:608148583018:web:f394b1d511e31190d61013"
        };
        
        // Initialize
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Exportar
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDB = db;
        window.firestoreModules = { collection, addDoc, getDocs };
        
        log('‚úÖ Firebase inicializado', 'success');
    </script>

    <script>
        function log(msg, type = 'info') {
            const logEl = document.getElementById('log');
            const line = document.createElement('div');
            line.className = `log-line ${type}`;
            line.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            logEl.appendChild(line);
            logEl.scrollTop = logEl.scrollHeight;
            console.log(msg);
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        async function testFirebase() {
            log('üîç Testando Firebase...', 'info');
            
            if (window.firebaseApp) {
                log('‚úÖ Firebase App: OK', 'success');
            } else {
                log('‚ùå Firebase App: FALHOU', 'error');
                return;
            }
            
            if (window.firebaseDB) {
                log('‚úÖ Firestore: OK', 'success');
            } else {
                log('‚ùå Firestore: FALHOU', 'error');
                return;
            }
            
            log('üéâ Todos os testes passaram!', 'success');
        }

        async function testAuth() {
            log('üîç Testando Authentication...', 'info');
            
            if (window.firebaseAuth) {
                log('‚úÖ Auth Module: OK', 'success');
                log(`üìß Email configurado: sofia@essenceexclusive.com`, 'info');
            } else {
                log('‚ùå Auth Module: FALHOU', 'error');
            }
        }

        async function testFirestore() {
            log('üîç Testando Firestore...', 'info');
            
            try {
                const { collection, getDocs } = window.firestoreModules;
                const querySnapshot = await getDocs(collection(window.firebaseDB, 'products'));
                
                log(`‚úÖ Firestore conectado!`, 'success');
                log(`üì¶ Produtos encontrados: ${querySnapshot.size}`, 'info');
                
                querySnapshot.forEach((doc) => {
                    log(`   - ${doc.data().name || 'Sem nome'}`, 'info');
                });
                
            } catch (error) {
                log(`‚ùå Erro: ${error.message}`, 'error');
                log(`üí° Verifique as regras do Firestore`, 'info');
            }
        }

        async function addTestProduct() {
            log('‚ûï Adicionando produto teste...', 'info');
            
            try {
                const { collection, addDoc } = window.firestoreModules;
                
                const testProduct = {
                    name: 'Produto Teste ' + new Date().getTime(),
                    category: 'masculino',
                    price: 99000,
                    rating: 5,
                    featured: true,
                    image: 'https://via.placeholder.com/400',
                    description: 'Produto de teste criado em ' + new Date().toLocaleString()
                };
                
                const docRef = await addDoc(collection(window.firebaseDB, 'products'), testProduct);
                
                log(`‚úÖ Produto criado com ID: ${docRef.id}`, 'success');
                log(`üì¶ Nome: ${testProduct.name}`, 'info');
                
            } catch (error) {
                log(`‚ùå Erro ao criar: ${error.message}`, 'error');
            }
        }

        async function loadAllProducts() {
            log('üì• Carregando todos os produtos...', 'info');
            
            try {
                const { collection, getDocs } = window.firestoreModules;
                const querySnapshot = await getDocs(collection(window.firebaseDB, 'products'));
                
                log(`‚úÖ ${querySnapshot.size} produtos carregados`, 'success');
                
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    log(`   ID: ${doc.id}`, 'info');
                    log(`   Nome: ${data.name}`, 'info');
                    log(`   Pre√ßo: $${data.price}`, 'info');
                    log(`   ---`, 'info');
                });
                
            } catch (error) {
                log(`‚ùå Erro: ${error.message}`, 'error');
            }
        }

        // Log inicial
        log('üöÄ Sistema de teste carregado', 'info');
        log('üí° Clique nos bot√µes para testar', 'info');
    </script>
</body>
</html>
